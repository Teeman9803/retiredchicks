var GridPlusSetting=GridPlusSetting||{};!function(t){"use strict";GridPlusSetting={vars:{grid_stack:t(".grid-stack"),custom_content_numb:0},init:function(){t(".grid-plus-wrap").css("opacity",1),GridPlusSetting.grid=null,GridPlusSetting.is_search=0,GridPlusSetting.options={cellHeight:10,verticalMargin:20,height:0,animate:!0,acceptWidgets:!0,removable:!0,width:12,resizable:{handles:"e, se, s, sw, w"}},GridPlusSetting.select_categories=null,GridPlusSetting.initControl(),GridPlusSetting.registerEvent(),GridPlusSetting.animation(),GridPlusSetting.initDepend(),GridPlusSetting.initSaveCtrS(),GridPlusSetting.registerGallery(),new Clipboard(".copy-clipboard").on("success",function(i){t(i.trigger).find("i.fa-check").length>0&&t(i.trigger).find("i.fa-check").remove(),t(i.trigger).append('<i class="fa fa-check active"> Copied!</i>'),i.clearSelection(),setTimeout(function(){t("i.active",i.trigger).fadeOut(function(){t(this).remove()})},2e3)}),t(".colorpicker").wpColorPicker(),GridPlusSetting.layout_custom_css=ace.edit("layout_custom_css"),GridPlusSetting.layout_custom_css.getSession().setMode("ace/mode/css"),GridPlusSetting.layout_custom_css.setAutoScrollEditorIntoView(!0),"undefined"!=typeof grid_script_data&&""!=grid_script_data.grid_id&&GridPlusSetting.processEditLayout(),GridPlusSetting.execCustomContent()},initControl:function(){GridPlusSetting.layout_id=t("#layout_id"),GridPlusSetting.layout_shortcode=t("#layout_shortcode"),GridPlusSetting.layout_name=t("#layout_name"),GridPlusSetting.layout_type=t("#layout_type"),GridPlusSetting.layout_col=t("#layout_col"),GridPlusSetting.layout_gutter=t("#layout_gutter"),GridPlusSetting.layout_item_per_page=t("#layout_item_per_page"),GridPlusSetting.layout_total_items=t("#layout_total_items"),GridPlusSetting.layout_fix_item_height=t("#layout_fix_item_height"),GridPlusSetting.layout_crop_image=t("#layout_crop_image"),GridPlusSetting.layout_disable_link=t("#layout_disable_link"),GridPlusSetting.layout_custom_content_enable=t("#layout_custom_content_enable"),GridPlusSetting.layout_custom_content=t("#layout_custom_content"),GridPlusSetting.layout_carousel_rtl=t("#layout_carousel_rtl"),GridPlusSetting.layout_carousel_total_items=t("#layout_carousel_total_items"),GridPlusSetting.layout_carousel_desktop_large_col=t("#layout_carousel_desktop_large_col"),GridPlusSetting.layout_carousel_desktop_large_width=t("#layout_carousel_desktop_large_width"),GridPlusSetting.layout_carousel_desktop_medium_col=t("#layout_carousel_desktop_medium_col"),GridPlusSetting.layout_carousel_desktop_medium_width=t("#layout_carousel_desktop_medium_width"),GridPlusSetting.layout_carousel_desktop_small_col=t("#layout_carousel_desktop_small_col"),GridPlusSetting.layout_carousel_desktop_small_width=t("#layout_carousel_desktop_small_width"),GridPlusSetting.layout_carousel_tablet_col=t("#layout_carousel_tablet_col"),GridPlusSetting.layout_carousel_tablet_width=t("#layout_carousel_tablet_width"),GridPlusSetting.layout_carousel_tablet_small_col=t("#layout_carousel_tablet_small_col"),GridPlusSetting.layout_carousel_tablet_small_width=t("#layout_carousel_tablet_small_width"),GridPlusSetting.layout_carousel_mobile_col=t("#layout_carousel_mobile_col"),GridPlusSetting.layout_carousel_mobile_width=t("#layout_carousel_mobile_width"),GridPlusSetting.layout_carousel_next_text=t("#layout_carousel_next_text"),GridPlusSetting.layout_carousel_prev_text=t("#layout_carousel_prev_text"),GridPlusSetting.layout_carousel_width_ratio=t("#layout_carousel_width_ratio"),GridPlusSetting.layout_carousel_height_ratio=t("#layout_carousel_height_ratio"),GridPlusSetting.layout_loop=t("#layout_loop"),GridPlusSetting.layout_center=t("#layout_center"),GridPlusSetting.layout_autoplay=t("#layout_autoplay"),GridPlusSetting.layout_autoplay_hover_pause=t("#layout_autoplay_hover_pause"),GridPlusSetting.layout_autoplay_time=t("#layout_autoplay_time"),GridPlusSetting.layout_show_dot=t("#layout_show_dot"),GridPlusSetting.layout_show_nav=t("#layout_show_nav"),GridPlusSetting.layout_carousel_nav_position=t("#layout_carousel_nav_position"),GridPlusSetting.layout_carousel_nav_style=t("#layout_carousel_nav_style"),GridPlusSetting.layout_justified_row_height=t("#layout_justified_row_height"),GridPlusSetting.layout_source=t("#layout_source"),GridPlusSetting.source_type=t("#source_type"),GridPlusSetting.attachment_type=t("#attachment_type"),GridPlusSetting.grid_gallery=t("#grid_gallery"),GridPlusSetting.custom_urls=t("#custom_urls"),GridPlusSetting.layout_category=t("#layout_category"),GridPlusSetting.layout_show_category=t("#layout_show_category"),GridPlusSetting.layout_cate_multi_line=t("#layout_cate_multi_line"),GridPlusSetting.layout_authors=t("#layout_authors"),GridPlusSetting.layout_exclude_ids=t("#layout_exclude_ids"),GridPlusSetting.layout_order=t("#layout_order"),GridPlusSetting.layout_order_by=t("#layout_order_by"),GridPlusSetting.layout_category_color=t("#layout_category_color"),GridPlusSetting.layout_category_hover_color=t("#layout_category_hover_color"),GridPlusSetting.layout_no_image_bg_color=t("#layout_no_image_bg_color"),GridPlusSetting.layout_bg_color=t("#layout_bg_color"),GridPlusSetting.layout_icon_color=t("#layout_icon_color"),GridPlusSetting.layout_icon_hover_color=t("#layout_icon_hover_color"),GridPlusSetting.layout_title_color=t("#layout_title_color"),GridPlusSetting.layout_title_hover_color=t("#layout_title_hover_color"),GridPlusSetting.layout_excerpt_color=t("#layout_excerpt_color"),GridPlusSetting.layout_animation_type=t("#layout_animation_type"),GridPlusSetting.layout_pagination_type=t("#layout_pagination_type"),GridPlusSetting.layout_page_prev_text=t("#layout_page_prev_text"),GridPlusSetting.layout_page_next_text=t("#layout_page_next_text"),GridPlusSetting.layout_page_loadmore_text=t("#layout_page_loadmore_text"),"metro"==GridPlusSetting.layout_type.val()&&(GridPlusSetting.layout_item_per_page=t("#metro_layout_item_per_page"),GridPlusSetting.layout_total_items=t("#metro_layout_total_items"),GridPlusSetting.layout_pagination_type=t("#metro_layout_pagination_type"),GridPlusSetting.layout_page_prev_text=t("#metro_layout_page_prev_text"),GridPlusSetting.layout_page_next_text=t("#metro_layout_page_next_text"),GridPlusSetting.layout_page_loadmore_text=t("#metro_layout_page_loadmore_text")),"attachment"==GridPlusSetting.layout_source.val()&&"choose_source"==GridPlusSetting.attachment_type.val()&&(GridPlusSetting.layout_authors=t("#attachment_layout_authors"),GridPlusSetting.layout_order=t("#attachment_layout_order"),GridPlusSetting.layout_order_by=t("#attachment_layout_order_by")),t("optgroup",GridPlusSetting.layout_category).remove(),GridPlusSetting.layout_category.append(t('optgroup[data-post-type="'+GridPlusSetting.layout_source.val()+'"]',"#layout_category_filter").clone()),GridPlusSetting.initSelectize()},initGridMoveAndResize:function(i){void 0!==GridPlusSetting.grid&&null!=GridPlusSetting.grid&&("grid"!=i&&"masonry"!=i||GridPlusSetting.grid.disable(),"metro"==i&&GridPlusSetting.grid.enable()),"grid"==i?t(".change-ratio",".action-groups").show():t(".change-ratio",".action-groups").hide(),"metro"==i?t(".change-item-ratio",".grid-stack-item").show():t(".change-item-ratio",".grid-stack-item").hide()},registerEvent:function(){t("a.add-item").on("click",function(){GridPlusSetting.showPopupSkin(function(t){var i=GridPlusSetting.estimateItemInfo(),e=i.width,a=i.height,l=i.system_col,r=i.col;GridPlusSetting.options.width=l,GridPlusSetting.grid.setGridWidth(l,!1),GridPlusSetting.processAddItem(e,a,r,t),GridPlusSetting.processUpdateItemPerPage(1)})}),t("a.change-item-style").on("click",function(){GridPlusSetting.showPopupSkin(function(i){t(".grid-stack-item").each(function(){GridPlusSetting.processInitItemStyle(t(this),i)})})}),t("a.save-layout",".grid-plus-container").off("click").on("click",function(){GridPlusSetting.processSaveGrid(this)}),t(".grid-post-item",".list-skins").each(function(){t(this).append('<a class="select-skin" href="javascript:;"><i class="fa fa-square-o"></i>Select</a>'),t("a.select-skin",this).off("click").on("click",function(){t("a.select-skin").html('<i class="fa fa-square-o"></i>Select'),t(this).html('<i class="fa fa-check-square-o"></i>Selected'),t(".grid-post-item",".list-skins").attr("data-skin-selected",0),t(this).parent().attr("data-skin-selected",1)})}),t("a.generate-layout").on("click",function(){GridPlusUtil.showLoading("Processing generate layout ..."),GridPlusSetting.vars.grid_stack.fadeOut(function(){GridPlusSetting.processGenerateLayout(),GridPlusSetting.vars.grid_stack.fadeIn(function(){GridPlusUtil.closeLoading(0)})})}),t("a.search-layout").on("click",function(){var i=t("input",t(this).parent());i.hasClass("active")?i.removeClass("active"):(i.val(""),i.addClass("active"),setTimeout(function(){i.focus(),i.attr("placeholder","Type grid name and enter to search")},300)),t(i).on("keypress",function(i){if("13"==(i.keyCode?i.keyCode:i.which)){var e=t(this).parent().parent().attr("data-ajax-url"),a=t(this).val();0==GridPlusSetting.is_search&&(GridPlusSetting.is_search=1,GridPlusSetting.processSearch("Searching grid ......",e,a))}})}),t(".refresh-layout").on("click",function(){if(0==GridPlusSetting.is_search){GridPlusSetting.is_search=1;var i=t(this).parent().attr("data-ajax-url");GridPlusSetting.processSearch("Refresh grid ......",i,"")}}),t(".change-ratio",".action-groups").on("click",function(){var i=wp.template("bg-prompt-change-height-dialog"),e=GridPlusSetting.vars.grid_stack.attr("data-height-ratio"),a=GridPlusSetting.vars.grid_stack.attr("data-width-ratio");void 0!==e&&""!=e||(e=1),void 0!==a&&""!=a||(a=1),t("body").append(i({height_ratio:e,width_ratio:a})),t("a.close-popup",".bg-popup-change-height").on("click",function(){t(".bg-popup-change-height").remove()}),t(".apply-change-height").on("click",function(){var i=t(".txt_height",".bg-popup-change-height").val(),e=t(".txt_width",".bg-popup-change-height").val(),a=t(".grid-stack-item-content",".grid-stack-item:first-child").width(),l=0;i=parseInt(i)<=0?1:i,e=parseInt(e)<=0?1:e,""!=i&&""!=e&&(GridPlusSetting.vars.grid_stack.attr("data-height-ratio",i),GridPlusSetting.vars.grid_stack.attr("data-width-ratio",e),a=parseInt(a),i=parseInt(i),e=parseInt(e),l=Math.floor(a*(i/e))/GridPlusSetting.options.cellHeight,GridPlusSetting.processChangeHeight(l)),t(".bg-popup-change-height").remove()})}),GridPlusSetting.layout_name.keyup(function(){GridPlusSetting.layout_shortcode.text('[grid_plus name="'+t(this).val()+'"]')}),GridPlusSetting.registerChangeTab()},initSelectize:function(){var i,e={plugins:["remove_button","drag_drop"],searchField:"text",delimiter:",",persist:!1};t("select:not(.manual)",".grid-plus-wrap").each(function(){i=t(this).attr("data-selected"),e.items=void 0!==i?i.split(","):[],t(this).selectize(e)}),i=GridPlusSetting.layout_category.attr("data-selected"),e.items=void 0!==i?i.split(","):[],GridPlusSetting.select_categories=GridPlusSetting.layout_category.selectize(e),void 0!==GridPlusSetting.select_categories[0]&&(GridPlusSetting.select_categories=GridPlusSetting.select_categories[0].selectize),GridPlusSetting.layout_exclude_ids.selectize({plugins:["remove_button"],valueField:"value",labelField:"label",searchField:"label",delimiter:",",options:[],create:!1,load:function(i,e){if(!i.length)return e();t.ajax({url:GridPlusSetting.layout_exclude_ids.attr("data-url")+"?action=grid_plus_get_posts",type:"GET",data:{title:i,post_type:GridPlusSetting.layout_source.val()},error:function(){e()},success:function(i){e(t.parseJSON(i))}})}}),GridPlusSetting.layout_custom_content.selectize({plugins:["remove_button"],valueField:"value",labelField:"label",searchField:"label",delimiter:",",options:[],create:!1,load:function(i,e){if(!i.length)return e();t.ajax({url:GridPlusSetting.layout_custom_content.attr("data-url")+"?action=grid_plus_get_posts",type:"GET",data:{title:i,post_type:GridPlusSetting.layout_custom_content.attr("data-post-type")},error:function(){e()},success:function(i){e(t.parseJSON(i))}})}})},initSaveCtrS:function(){t(window).bind("keydown",function(i){if((i.ctrlKey||i.metaKey)&&"s"===String.fromCharCode(i.which).toLowerCase())return i.preventDefault(),t("a.save-layout","#layout-config").trigger("click"),!1})},initDepend:function(){t("[data-depend-control]").each(function(){var i=t(this).attr("data-depend-control"),e=t("#"+i),a="",l=","+t(this).attr("data-depend-value")+",",r=","+t(this).attr("data-depend-dif-value")+",";void 0!==e&&e.length>0&&(a=e.val(),e.is(":checkbox")&&(a=e.is(":checked")),e.is(":radio")&&(a=t("#"+i+":checked").val()),l.indexOf(","+a+",")>=0?t(this).css({display:"inline-block"}):",undefined,"!=r&&r.indexOf(","+a+",")<0?t(this).css({display:"inline-block"}):t(this).css({display:"none"}),e.off("change").on("change",function(i){if(i.preventDefault(),"layout_type"!=t(this).attr("id")&&"layout_custom_content_enable"!=t(this).attr("id")||GridPlusSetting.execCustomContent(),"layout_type"==t(this).attr("id")){var e=t(this).val();"grid"==e?t(".change-ratio",".action-groups").show():t(".change-ratio",".action-groups").hide(),"metro"==e?t(".change-item-ratio",".grid-stack-item").show():t(".change-item-ratio",".grid-stack-item").hide(),GridPlusSetting.initGridMoveAndResize(e)}if("layout_source"==t(this).attr("id")){var a=t(this).val();GridPlusSetting.select_categories.destroy(),t("optgroup",GridPlusSetting.layout_category).remove(),GridPlusSetting.layout_category.append(t('optgroup[data-post-type="'+a+'"]',"#layout_category_filter").clone()),GridPlusSetting.initSelectize()}GridPlusSetting.initDepend()}))})},initGridStack:function(i,e,a,l){t('select[name="padding"]').val();var r=GridPlusSetting.estimateItemInfo(),o=r.width,s=r.height,n=r.system_col;l=parseInt(l),GridPlusSetting.options.verticalMargin=l,GridPlusSetting.options.width=n,GridPlusSetting.vars.grid_stack.attr("data-gutter","gutter-"+l),GridPlusSetting.vars.grid_stack.attr("data-layout",i),GridPlusSetting.vars.grid_stack.gridstack(GridPlusSetting.options),GridPlusSetting.grid=GridPlusSetting.vars.grid_stack.data("gridstack"),GridPlusSetting.grid.verticalMargin(l,!0),GridPlusSetting.grid.removeAll();for(var u=0;u<a;u++)GridPlusSetting.processAddItem(o,s,e)},initGridStackEdit:function(i,e,a,l,r,o){var s=GridStackUI.Utils.sort(i,1),n=null;GridPlusSetting.vars.grid_stack.attr("data-height-ratio",l),GridPlusSetting.vars.grid_stack.attr("data-width-ratio",r),GridPlusSetting.vars.grid_stack.attr("data-gutter","gutter-"+e),GridPlusSetting.vars.grid_stack.attr("data-layout",o),"grid"==o||"masonry"==o||5==a?(GridPlusSetting.options.width=a,GridPlusSetting.vars.grid_stack.addClass("grid-stack-"+a)):GridPlusSetting.options.width=12,"metro"==o?t(".change-item-ratio",".grid-stack-item").show():t(".change-item-ratio",".grid-stack-item").hide(),GridPlusSetting.options.verticalMargin=e,GridPlusSetting.vars.grid_stack.gridstack(GridPlusSetting.options),GridPlusSetting.grid=GridPlusSetting.vars.grid_stack.data("gridstack"),GridPlusSetting.grid.verticalMargin(e,!1),GridPlusSetting.grid.removeAll(),_.each(s,function(i){n=GridPlusSetting.grid.addWidget(t('<div><div class="grid-stack-item-content" /></div>'),i.x,i.y,i.width,i.height),GridPlusSetting.registerRemoveGridStackItem(n),GridPlusSetting.registerChangeItemStyle(n),GridPlusSetting.registerChangeItemRatio(n),GridPlusSetting.processInitItemStyle(n,i.skin,i.item_width_ratio,i.item_height_ratio)},this)},registerRemoveGridStackItem:function(i){t(".grid-stack-item-content",i).append('<a class="remove-item" title="Remove item"><i class="fa fa-trash-o"></i></a>'),t("a",i).off("click").on("click",function(){GridPlusSetting.grid.removeWidget(i),GridPlusSetting.processUpdateItemPerPage(-1)})},registerChangeItemRatio:function(i){t(".grid-stack-item-content",i).append('<div class="change-item-ratio"><a href="javascript:;" title="Change item ratio"><i class="fa fa-qrcode"></i></a>'),t(".change-item-ratio a",i).off("click").on("click",function(){var i=t(this).closest(".grid-stack-item"),e=i.children(".grid-stack-item-content"),a=wp.template("bg-prompt-change-item-height-dialog"),l=i.attr("data-item-height-ratio"),r=i.attr("data-item-width-ratio");void 0!==l&&""!=l||(l=1),void 0!==r&&""!=r||(r=1),t("body").append(a({height_ratio:l,width_ratio:r})),t("a.close-popup",".bg-popup-change-item-height").on("click",function(){t(".bg-popup-change-item-height").remove()}),t(".apply-change-item-height",".bg-popup-change-item-height").on("click",function(){var a=t(".txt_height",".bg-popup-change-item-height").val(),l=t(".txt_width",".bg-popup-change-item-height").val(),r=e.width(),o=e.height(),s=i.attr("data-gs-height"),n=Math.ceil(o/s),u=0,d=0;a=parseInt(a)<=0?1:a,l=parseInt(l)<=0?1:l,""!=a&&""!=l&&(i.attr("data-item-height-ratio",a),i.attr("data-item-width-ratio",l),r=parseInt(r),a=parseInt(a),l=parseInt(l),d=Math.floor(r*(a/l)),u=Math.floor(d/n),GridPlusSetting.processChangeItemHeight(i,u)),t(".bg-popup-change-item-height").remove()})})},registerChangeItemStyle:function(i){t(".grid-stack-item-content",i).append('<div class="change-style"><a href="javascript:;" title="Change skin"><i class="fa fa-paint-brush"></i></a>'),t(".change-style a",i).off("click").on("click",function(){GridPlusSetting.showPopupSkin(function(t){GridPlusSetting.processInitItemStyle(i,t)})})},registerChangeTab:function(){t("a",".grid-plus-wrap .nav-tabs").on("click",function(){var i=t(this).attr("data-section-id");void 0!==i&&(t("li",".grid-plus-wrap .nav-tabs").removeClass("tab-current"),void 0!==t(this).attr("data-external")?t('a[data-section-id="'+i+'"]',".grid-plus-wrap .nav-tabs").parent().addClass("tab-current"):t(this).parent().addClass("tab-current"),t("section",".grid-plus-wrap .content-wrap").hide(),t("#"+i,".grid-plus-wrap .content-wrap").show())})},registerGallery:function(){t(".sf-field-gallery-inner",".grid-plus-wrap").each(function(){new SF_GalleryClass(t(this)).init()})},estimateItemInfo:function(){var i=parseInt(GridPlusSetting.layout_col.val()),e=Math.floor(12/i),a=Math.floor(12/i),l=GridPlusSetting.layout_type.val(),r=GridPlusSetting.layout_gutter.val(),o=t(".grid-stack-container").width(),s=Math.floor(parseInt(o)/i),n=GridPlusSetting.vars.grid_stack.attr("data-height-ratio"),u=GridPlusSetting.vars.grid_stack.attr("data-width-ratio"),d=12;if("grid"!=l&&"masonry"!=l&&5!=i||(e=1,d=i),"grid"==l)a=void 0!==n&&void 0!==u&&""!=u&&""!=n?Math.floor(s*(n/u)/GridPlusSetting.options.cellHeight):Math.floor(s/GridPlusSetting.options.cellHeight);else switch(i){case 2:a=r>0?15:40;break;case 3:case 4:a=r>0?15:30;break;case 5:case 6:a=r>0?10:20}return{width:e,height:a,system_col:d,col:i}},processSaveGrid:function(i){if("carousel"!=GridPlusSetting.layout_type.val()&&"justified"!=GridPlusSetting.layout_type.val()){if(void 0===GridPlusSetting.grid||0==t(".grid-stack-item",".grid-stack").length)return void GridPlusUtil.popupAlert("fa fa-exclamation-triangle","Please generate layout before save");if(!GridPlusSetting.isValidateLayout())return void GridPlusUtil.popupAlert("fa fa-exclamation-triangle","Please generate layout when change layout type before save")}GridPlusUtil.showLoading("Save Grid Settings"),"metro"==GridPlusSetting.layout_type.val()?(GridPlusSetting.layout_item_per_page=t("#metro_layout_item_per_page"),GridPlusSetting.layout_total_items=t("#metro_layout_total_items"),GridPlusSetting.layout_pagination_type=t("#metro_layout_pagination_type"),GridPlusSetting.layout_page_prev_text=t("#metro_layout_page_prev_text"),GridPlusSetting.layout_page_next_text=t("#metro_layout_page_next_text"),GridPlusSetting.layout_page_loadmore_text=t("#metro_layout_page_loadmore_text")):(GridPlusSetting.layout_item_per_page=t("#layout_item_per_page"),GridPlusSetting.layout_total_items=t("#layout_total_items"),GridPlusSetting.layout_pagination_type=t("#layout_pagination_type"),GridPlusSetting.layout_page_prev_text=t("#layout_page_prev_text"),GridPlusSetting.layout_page_next_text=t("#layout_page_next_text"),GridPlusSetting.layout_page_loadmore_text=t("#layout_page_loadmore_text")),"attachment"==GridPlusSetting.layout_source.val()&&"choose_source"==GridPlusSetting.attachment_type.val()&&(GridPlusSetting.layout_authors=t("#attachment_layout_authors"),GridPlusSetting.layout_order=t("#attachment_layout_order"),GridPlusSetting.layout_order_by=t("#attachment_layout_order_by"));var e="thumbnail";t('.grid-post-item[data-skin-selected="1"]',".list-skins").length>0&&(e=t('.grid-post-item[data-skin-selected="1"]',".list-skins").closest(".skin-item").attr("data-skin"));var a="all";"post"==GridPlusSetting.layout_source.val()?(a=t("#layout_source_filter").val(),GridPlusSetting.layout_order=t("#layout_post_order"),GridPlusSetting.layout_order_by=t("#layout_post_order_by")):"product"==GridPlusSetting.layout_source.val()?(a=t("#layout_product_source_filter").val(),GridPlusSetting.layout_order=t("#layout_product_order"),GridPlusSetting.layout_order_by=t("#layout_product_order_by")):(GridPlusSetting.layout_order=t("#layout_order"),GridPlusSetting.layout_order_by=t("#layout_order_by"));var l=GridPlusSetting.layout_carousel_next_text.val(),r=GridPlusSetting.layout_carousel_prev_text.val(),o=GridPlusSetting.layout_page_loadmore_text.val(),s=GridPlusSetting.layout_page_next_text.val(),n=GridPlusSetting.layout_page_prev_text.val();void 0!==l&&(l=l.replace(/"/g,"&quot;")),void 0!==r&&(r=r.replace(/"/g,"&quot;")),void 0!==o&&(o=o.replace(/"/g,"&quot;")),void 0!==s&&(s=s.replace(/"/g,"&quot;")),void 0!==n&&(n=n.replace(/"/g,"&quot;"));var u=GridPlusSetting.vars.grid_stack.attr("data-height-ratio"),d=GridPlusSetting.vars.grid_stack.attr("data-width-ratio");void 0!==u&&""!=u&&0!=u||(u=1),void 0!==d&&""!=d&&0!=d||(d=1),GridPlusSetting.layout_gutter.val()<0&&GridPlusSetting.layout_gutter.val(0),GridPlusSetting.layout_gutter.val()>70&&GridPlusSetting.layout_gutter.val(70),GridPlusSetting.vars.custom_content_numb=0;var g=GridPlusSetting.vars.grid_stack.height(),c=_.map(t(".grid-stack > .grid-stack-item"),function(i){var e=(i=t(i)).data("_gridstack_node");"custom-content"==i.attr("data-skin")&&GridPlusSetting.vars.custom_content_numb++;var a=i.attr("data-item-width-ratio"),l=i.attr("data-item-height-ratio");return void 0!==a&&void 0!==l||(a=i.children(".grid-stack-item-content").width(),l=i.height()),a=a<=0?1:a,l=l<=0?1:l,{x:e.x,y:e.y,width:e.width,height:e.height,skin:i.attr("data-skin"),skin_css:i.attr("data-skin-css"),template:i.attr("data-skin-template"),item_width_ratio:a,item_height_ratio:l}},this),p={id:GridPlusSetting.layout_id.val(),name:GridPlusSetting.layout_name.val(),height:g,height_ratio:u,width_ratio:d,type:GridPlusSetting.layout_type.val(),columns:GridPlusSetting.layout_col.val(),gutter:GridPlusSetting.layout_gutter.val(),item_per_page:GridPlusSetting.layout_item_per_page.val(),total_item:GridPlusSetting.layout_total_items.val(),fix_item_height:GridPlusSetting.layout_fix_item_height.is(":checked"),crop_image:GridPlusSetting.layout_crop_image.is(":checked"),disable_link:GridPlusSetting.layout_disable_link.is(":checked"),custom_content_enable:GridPlusSetting.layout_custom_content_enable.is(":checked"),custom_content:GridPlusSetting.layout_custom_content.val(),custom_content_numb:GridPlusSetting.vars.custom_content_numb,loop:GridPlusSetting.layout_loop.is(":checked"),center:GridPlusSetting.layout_center.is(":checked"),justified_row_height:GridPlusSetting.layout_justified_row_height.val(),main_skin:e,carousel_rtl:GridPlusSetting.layout_carousel_rtl.is(":checked"),carousel_height_ratio:GridPlusSetting.layout_carousel_height_ratio.val(),carousel_width_ratio:GridPlusSetting.layout_carousel_width_ratio.val(),carousel_next_text:l,carousel_prev_text:r,carousel_total_items:GridPlusSetting.layout_carousel_total_items.val(),carousel_desktop_large_col:GridPlusSetting.layout_carousel_desktop_large_col.val(),carousel_desktop_large_width:GridPlusSetting.layout_carousel_desktop_large_width.val(),carousel_desktop_medium_col:GridPlusSetting.layout_carousel_desktop_medium_col.val(),carousel_desktop_medium_width:GridPlusSetting.layout_carousel_desktop_medium_width.val(),carousel_desktop_small_col:GridPlusSetting.layout_carousel_desktop_small_col.val(),carousel_desktop_small_width:GridPlusSetting.layout_carousel_desktop_small_width.val(),carousel_tablet_col:GridPlusSetting.layout_carousel_tablet_col.val(),carousel_tablet_width:GridPlusSetting.layout_carousel_tablet_width.val(),carousel_tablet_small_col:GridPlusSetting.layout_carousel_tablet_small_col.val(),carousel_tablet_small_width:GridPlusSetting.layout_carousel_tablet_small_width.val(),carousel_mobile_col:GridPlusSetting.layout_carousel_mobile_col.val(),carousel_mobile_width:GridPlusSetting.layout_carousel_mobile_width.val(),autoplay:GridPlusSetting.layout_autoplay.is(":checked"),autoplay_hover_pause:GridPlusSetting.layout_autoplay_hover_pause.is(":checked"),autoplay_time:GridPlusSetting.layout_autoplay_time.val(),show_dot:GridPlusSetting.layout_show_dot.is(":checked"),show_nav:GridPlusSetting.layout_show_nav.is(":checked"),carousel_nav_position:GridPlusSetting.layout_carousel_nav_position.val(),carousel_nav_style:GridPlusSetting.layout_carousel_nav_style.val(),animation_type:GridPlusSetting.layout_animation_type.val(),pagination_type:GridPlusSetting.layout_pagination_type.val(),page_next_text:s,page_prev_text:n,page_loadmore_text:o,category_color:GridPlusSetting.layout_category_color.val(),category_hover_color:GridPlusSetting.layout_category_hover_color.val(),no_image_background_color:GridPlusSetting.layout_no_image_bg_color.val(),background_color:GridPlusSetting.layout_bg_color.val(),icon_color:GridPlusSetting.layout_icon_color.val(),icon_hover_color:GridPlusSetting.layout_icon_hover_color.val(),title_color:GridPlusSetting.layout_title_color.val(),title_hover_color:GridPlusSetting.layout_title_hover_color.val(),excerpt_color:GridPlusSetting.layout_excerpt_color.val(),custom_css:GridPlusSetting.layout_custom_css.getValue()},y={post_type:GridPlusSetting.layout_source.val(),source_type:GridPlusSetting.source_type.val(),grid_gallery:GridPlusSetting.grid_gallery.val(),categories:GridPlusSetting.layout_category.val(),show_category:GridPlusSetting.layout_show_category.val(),cate_multi_line:GridPlusSetting.layout_cate_multi_line.is(":checked"),authors:GridPlusSetting.layout_authors.val(),exclude_ids:GridPlusSetting.layout_exclude_ids.val(),source_filter:a,attachment_type:GridPlusSetting.attachment_type.val(),custom_urls:GridPlusSetting.custom_urls.val(),order:GridPlusSetting.layout_order.val(),order_by:GridPlusSetting.layout_order_by.val()},h=t(i).parent().attr("data-ajax-url");c=_.sortBy(c,function(t){return t.y}),c=GridStackUI.Utils.sort(c),t.ajax({url:h,type:"POST",data:{action:"grid_plus_save_layout",grid_config:p,grid_data_source:y,grid_layout:c},success:function(t){void 0!==(t=JSON.parse(t)).code&&"-1"==t.code?(GridPlusUtil.closeLoading(0),GridPlusUtil.popupAlert("fa fa-exclamation-triangle",t.message)):(GridPlusSetting.layout_id.val(t.id),GridPlusSetting.layout_shortcode.val('[grid_plus name="'+GridPlusSetting.layout_name.val()+'"]'),GridPlusUtil.changeLoadingStatus("fa fa-check-square-o","Grid setting saved"),GridPlusUtil.closeLoading())},error:function(){GridPlusUtil.changeLoadingStatus("fa fa-exclamation-triangle","Have error when save information"),GridPlusUtil.closeLoading()}})},processGenerateLayout:function(){var i=t("#layout_name").val(),e=t("#layout_type").val(),a=t("#layout_col").val(),l=t("#layout_item_per_page").val(),r=t("#layout_total_items").val(),o=t("#layout_gutter").val(),s="grid-stack-"+a;"show_all"==t("#layout_pagination_type").val()&&(l=2*a),t("#grid_id",".grid-plus-layout").val(),t("#grid_name",".grid-plus-layout").val(i),t("#grid_type",".grid-plus-layout").val(e),t("#grid_col",".grid-plus-layout").val(a),t("#grid_gutter",".grid-plus-layout").val(o),t("#grid_item_per_page",".grid-plus-layout").val(l),t("#grid_items",".grid-plus-layout").val(r);for(var n=1;n<=12;n++)GridPlusSetting.vars.grid_stack.removeClass("grid-stack-"+n);"metro"==e&&5!=a||GridPlusSetting.vars.grid_stack.addClass(s),a=parseInt(a),l=parseInt(l),GridPlusSetting.initGridStack(e,a,l,o),GridPlusSetting.initGridMoveAndResize(e)},processAddItem:function(i,e,a,l){var r=t(".grid-stack-item:last-child"),o=0,s=0,n=i,u=0,d=0,_=t(".grid-stack-item").length;void 0!==r&&r.length>0&&(o=r.attr("data-gs-y"),s=r.attr("data-gs-x"),n=r.attr("data-gs-width"),_%a==0?(u=0,d=Math.floor(_/a)*e):(d=o,u=parseInt(s)+parseInt(n)));var g={x:u,y:d,width:i,height:e};void 0!==GridPlusSetting.grid&&null!=GridPlusSetting.grid||(GridPlusSetting.vars.grid_stack.gridstack(GridPlusSetting.options),GridPlusSetting.grid=GridPlusSetting.vars.grid_stack.data("gridstack"));var c=GridPlusSetting.grid.addWidget(t('<div><div class="grid-stack-item-content stack-item-has-bg"/></div>'),g.x,g.y,g.width,g.height,!1);if(void 0===l||""==l){var p=t('.grid-post-item[data-skin-selected="1"]',".list-skins");l="thumbnail",p.length>0&&(l=p.closest(".skin-item").attr("data-skin"))}GridPlusSetting.registerRemoveGridStackItem(c),GridPlusSetting.registerChangeItemStyle(c),GridPlusSetting.registerChangeItemRatio(c),GridPlusSetting.processInitItemStyle(c,l,1,1)},processInitItemStyle:function(i,e,a,l){var r=t(".grid-stack-item-content",i),o=t('li[data-skin="'+e+'"]',".list-skins"),s=t(".grid-post-item",o),n="",u="",d="",_="";0==s.length&&(o=t("li:first-child",".list-skins"),s=t(".grid-post-item:first-child",".list-skins")),n=o.attr("data-skin"),d=o.attr("data-skin-css"),u=o.attr("data-skin-template"),s=s.clone(),void 0!==(_=t(".thumbnail-image",s).attr("data-img"))&&""!=_&&(t(".thumbnail-image img",s).remove(),t(".thumbnail-image",s).css("background-image",'url("'+_+'")')),t("a.select-skin",s).remove(),i.fadeOut(function(){t(".grid-post-item",i).length>0&&t(".grid-post-item",i).remove(),i.attr("data-skin",n),i.attr("data-skin-css",d),i.attr("data-skin-template",u),i.attr("data-item-height-ratio",l),i.attr("data-item-width-ratio",a),r.append(s),i.fadeIn()})},processUpdateItemPerPage:function(i){var e=t("#layout_item_per_page").val();t("#layout_item_per_page").val(parseInt(e)+i),t("#grid_item_per_page",".grid-plus-layout").val(parseInt(e)+i)},processEditLayout:function(){GridPlusUtil.showLoading("Loading layout information"),t.ajax({url:grid_script_data.ajax_url,type:"POST",data:{action:"grid_plus_get_info",grid_id:grid_script_data.grid_id},success:function(i){var e=JSON.parse(i);if("-1"==typeof e.code)return GridPlusUtil.closeLoading(0),void GridPlusUtil.popupAlert("fa fa-exclamation-triangle",e.message);if(void 0!==e.grid_config){var a=t('.skin-item[data-skin="'+e.grid_config.main_skin+'"]',".list-skins");a.length>0&&(t(".grid-post-item",a).attr("data-skin-selected",1),t(".select-skin",a).html('<i class="fa fa-check-square-o"></i>Selected'))}GridPlusSetting.initGridStackEdit(e.grid_layout,e.grid_config.gutter,e.grid_config.columns,e.grid_config.height_ratio,e.grid_config.width_ratio,e.grid_config.type),GridPlusSetting.initGridMoveAndResize(e.grid_config.type),GridPlusUtil.changeLoadingStatus("fa fa-check-square-o","Information has been loaded"),GridPlusUtil.closeLoading(500)},error:function(){GridPlusUtil.changeLoadingStatus("fa fa-exclamation-triangle","Have error when load information"),GridPlusUtil.closeLoading()}})},processRebindListGrid:function(i){var e=wp.template("list-grid-template");t("tr","#table_list_grid tbody").empty(),void 0!==i&&i.length>0&&t("tbody","#table_list_grid").append(e(i)),GridPlusSetting.registerGridAction()},processSearch:function(i,e,a){GridPlusUtil.showLoading(i),t.ajax({url:e,type:"POST",data:{action:"grid_plus_get_list",grid_name:a},success:function(t){GridPlusUtil.changeLoadingStatus("fa fa-check-square-o","Binding grid"),GridPlusUtil.closeLoading(500),t=JSON.parse(t),GridPlusSetting.processRebindListGrid(t),GridPlusSetting.is_search=0},error:function(){GridPlusUtil.changeLoadingStatus("fa fa-exclamation-triangle","Have error when delete information"),GridPlusUtil.closeLoading(),GridPlusSetting.is_search=0}})},processChangeHeight:function(i){var e=0,a=0,l=0,r=0;t(".grid-stack-item").each(function(){r=parseInt(t(this).attr("data-gs-height")),e=i-r,a=parseInt(t(this).attr("data-gs-y")),l=parseInt(t(this).attr("data-gs-width")),t(this).attr("data-gs-height",i),a>0&&t(this).attr("data-gs-y",a+e),void 0!==GridPlusSetting.grid&&GridPlusSetting.grid.resize(t(this),l,i)}),void 0!==GridPlusSetting.grid&&(GridPlusSetting.grid.batchUpdate(),GridPlusSetting.grid.commit())},processChangeItemHeight:function(i,e){var a=0,l=0,r=0;a=e-parseInt(i.attr("data-gs-height")),l=parseInt(i.attr("data-gs-y")),r=parseInt(i.attr("data-gs-width")),i.attr("data-gs-height",e),l>0&&t(this).attr("data-gs-y",l+a),void 0!==GridPlusSetting.grid&&GridPlusSetting.grid.resize(i,r,e)},isValidateLayout:function(){var i=GridPlusSetting.layout_type.val(),e=(GridPlusSetting.layout_col,t(".grid-stack-item"));if("grid"==i||"masonry"==i)for(var a=0;a<e.length;a++)if(t(e[a]).prev().length>0&&parseInt(t(e[a]).attr("data-gs-width"))!=parseInt(t(e[a]).prev().attr("data-gs-width")))return!1;return!0},showPopupSkin:function(i){var e=t("#list_skins").clone(!0),a=t('<div class="grid-plus-container"></div>'),l=t('<div class="bg-popup-skins"></div>');t("li",e).removeClass("col-md-3").addClass("col-md-4"),a.append(e),l.append(a),a.append('<a href="javascript:;" class="close-popup"><i class="fa fa-times"></i></a>'),t(".select-skin i",a).removeClass("fa fa-check-square-o").addClass("fa fa-square-o"),t("body").append(l),t(".grid-plus-container .grid-plus-layout",l).perfectScrollbar({wheelSpeed:.5,suppressScrollX:!0}),t("a.close-popup",l).on("click",function(){l.remove()}),t("a.select-skin",l).off("click").on("click",function(e){return l.remove(),i&&i(t(this).closest(".skin-item").attr("data-skin")),e.preventDefault(),!1})},animation:function(){t("#layout_animation_type").on("change",function(){var i=t(".animation-wrap");i.attr("class","animation-wrap animated "+t(this).val()),setTimeout(function(){i.attr("class","animation-wrap")},1e3)}),t(".preview-animation").on("click",function(){t("#layout_animation_type").trigger("change")})},execCustomContent:function(){var i=t("#layout_type").val(),e=t("#layout_custom_content_enable").is(":checked"),a=t('[data-skin="custom-content"]',".list-skins");"metro"!=i||"true"!=e&&!e?(a.css("display","none"),"1"==t(".grid-post-item",a).attr("data-skin-selected")&&t(".select-skin",'.list-skins [data-skin="thumbnail"]').trigger("click")):a.css("display","inline-block")}},t(document).ready(function(){GridPlusSetting.init()})}(jQuery);